\RequirePackage{fix-cm}
\documentclass[titlepage]{article}

\usepackage[utf8]{inputenc}
\usepackage{fullpage}    % Use the whole page
\usepackage{fancyhdr}    % Nice headers/footers
\usepackage{mdwlist}     % For itemize* and enumerate*
\usepackage{graphicx}    % Importing graphics
\usepackage{hyperref}    % Hyperlink references and URLs
\usepackage[figure,table]{hypcap} % Hyperlink points to the top of figures
\usepackage[usenames,dvipsnames]{xcolor}	% Logo
\usepackage{tikz,ifthen}			% Logo
\usepackage{pgf}				% Logo
\usepackage{scalefnt}				% Logo
\usepgfmodule{shapes}				% Logo
\usepgfmodule{plot}				% Logo
\usetikzlibrary{shapes,arrows,shadows,fit}
\usepackage{pgf-umlsd}
\usepackage{multirow}
\usepackage{mdwlist}
\usepackage{colortbl}

\makecompactlist{itemizecompact}{itemize}
\newcommand{\operations}[1]{
\begin{center}
    \begin{tabular}{|p{3cm}|p{9cm}|}
    \hline
    \multicolumn{2}{|l|}{\cellcolor[gray]{0.5}{\textbf{Operations}}} \\ \hline
#1
    \end{tabular}
\end{center}
}
\newcommand{\operation}[4]{
    \hline
    \multicolumn{2}{|l|}{\cellcolor[gray]{0.8}{#1}} \\ \hline
    \textbf{Input} & #2 \\ \hline
    \textbf{Output} & #3 \\ \hline
    \textbf{Description} & #4 \\ \hline
}

\newcommand{\attributes}[1]{
    \begin{center}
        \begin{tabular}{|p{4cm}|p{4cm}|p{4cm}|}
            \multicolumn{3}{|l|}{\cellcolor[gray]{0.5}{\textbf{Attributes}}} \\ \hline
            \rowcolor[gray]{0.8} Name & Type & Description \\ \hline \hline
            #1
        \end{tabular}
    \end{center}
}

\newcommand{\attribute}[3]{
    \texttt{#1} & \texttt{#2} & #3 \\ \hline
}

% Just so we don't have to specify this twice
\newcommand\mytitle{Software Design Specification}
\newcommand\mydate{\today}
\newcommand\myversion{1}

\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    urlcolor=blue,
    pdftitle={AHOY Software Design Specification V\myversion},
    pdfauthor={Dustin Ingram, Aaron Rosenfeld, Maria Kolakowska, Frank Clark}
}

% So we can number subsubsections too
\setcounter{secnumdepth}{5}

% For headers and footers
\setlength{\headheight}{15pt}
\setlength{\headsep}{25pt}
\pagestyle{fancy}
	
% Page style for the title page
\fancypagestyle{plain}{
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}

% Page style for every other page
\fancyhf{} % clear all header and footer fields
\fancyhead[L]{AHOY}
\fancyhead[C]{\mytitle}
\fancyhead[R]{\mydate}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\title{\textbf{\mytitle}}
\author{
	Frank Clark \\\url{francis.j.clark@drexel.edu}
    \and Dustin Ingram \\\url{dustin.s.ingram@drexel.edu}
	\and Maria Kolakowska \\\url{maria.j.kolakowska@drexel.edu}
    \and Aaron Rosenfeld \\\url{aaron.rosenfeld@drexel.edu}
}
\date{\mydate\\Version \myversion}

%%% Tikz stuff %%%
% Style for UML Class with attributes and methods
%BEGIN IMAGE
\tikzstyle{umlclass} = [
    rectangle, rectangle split, rectangle split parts=3,
    % This makes a nice gradient
    top color=white, bottom color=blue!30, draw=blue!50!black!100,
    drop shadow, rounded corners,
    node distance = 5cm, text width = 5cm]
\tikzstyle{component} = [umlclass, rectangle split parts=0, text width =, node distance=3.14159cm]
% Line styles
\tikzstyle{hasa} = [draw, <-, >=open diamond]
\tikzstyle{ownsa} = [draw, ->, >=diamond]
\tikzstyle{isa} = [draw, ->, >=open triangle 45]

\newcommand{\umlclass}[5][,]{
    \node [umlclass,#1] (#2) {
        \textbf{#3}
        \nodepart{second}
        \begin{description*}
        #4
        \end{description*}
        \nodepart{third}
        \begin{description*}
        #5
        \end{description*}
    };
}

\newcommand{\umlattr}[3]{
    \item[$#1$]\textbf{#2}: \textit{#3}
}
\newcommand{\umlmethod}[4]{
    \item[$#1$]\textbf{#2}({#3}): \textit{#4}
}
\newcommand{\umlarg}[2]{\textit{#1} #2}

\newcommand{\umlrelation}[6][-|]{
    \path [#3] (#2) #1 (#4)
        node [very near start, auto=right] {#5}
        node [very near end, auto=right] {#6};
}
%END IMAGE
%%% End tikz stuff %%%

\begin{document}
\pagenumbering{roman}

\begin{figure*}
   % \vspace{-2em}
    \centering
    \scalebox{0.8}{\input{../common/logo.tikz}}
    \vspace{-4em}
\end{figure*}

\maketitle

\begin{abstract}
AHOY is an event-based simulation environment used to compare the effectiveness of different combinations of software agents, network configurations, and sensor data in real-world environments.  It is comprised of a distributed simulation engine, visualizer, and programming interface through which developers create agent software and network topologies.  Communication between virtual nodes is also simulated, providing highly realistic scenarios.
\end{abstract}

\setcounter{tocdepth}{4}
\tableofcontents
\pagebreak
\listoffigures
\pagebreak
\pagenumbering{arabic}

\section{Introduction}
\subsection{Purpose}
\subsection{Scope}
\subsection{Design Goals}
\subsection{Definitions, Acronyms, and Abbreviations}
\begin{description}
\item[Agent]
	Agents are simulated pieces of software that run on nodes in the network. They consist of different algorithms that are relevant for the user to test on different scenarios and topologies.   

\item[Distribution]
	Distribution refers to the process of distributing the simulation across a multi-platform physical cluster.  This allows the system to exceed the number of nodes per platform for a single simulation at the system's discretion.  A framework will be provided to allow the user to distribute their simulation. 	

\item[Node]
	Nodes are virtual or physical machines that consist of agents and network interfaces.  If nodes are virtual, many nodes may run on one physical machine.  

\item[Scenario]
	Scenario is comprised of a scripted language indicating the location simulated nodes within the virtual world. These nodes consist of agents (see definition of `Agent') and non-agent world objects such as planes, boats, ground vehicles, etc. 

\item[Terrain]
	Terrain refers to the simulated landscape.  This includes such geography as the slope of the land, the tree density, water v.s. land surfaces, etc.

\item[Topology]
	Topology describes time-dependent connections between nodes and their characteristics (e.g. radio model). It is described with a scripting language which specifies the details of network interfaces on each simulated node, including radio models and throughput characteristics.  It describes any physical or wireless links that connect these interfaces.  Further, it indicates changes in linkage over time such as a wireless interface switches, wireless LANs, or a physical link being created or severed. 

\item[Visualizer]
	The Visualizer allows the simulations to be superimposed over real-world topography.  This permits the user to examine the behavior of the agents.  It also allows for overlays such as link quality, traffic rates, and other metrics deemed important to specific components.
\end{description}

\subsection{References}

\section{Design Overview}
\subsection{Description of Problem}
\subsection{Subsystem Diagram}
\begin{figure}[!h]
    \centering
    \begin{tikzpicture}[node distance=.5cm]
        \node [component] (Entity) {\textbf{Entities}};
        \node [component, right of=Entity] (World) {\textbf{World}};
        \node [component, right of=World] (Simulation) {\textbf{Simulation}};
        \node [component, below left of=Entity] (Agent) {\textbf{Agents}};
        \node [component, below right of=Entity] (Sensor) {\textbf{Sensors}};
        \node [component, below of=Entity] (Interface) {\textbf{Interfaces}};
        \draw [draw, <-, >=open diamond] (Simulation) -- (World);
        \draw [draw, ->, >=open diamond] (Entity) -- (World);
        \draw [draw, <-, >=open diamond] (Entity) -- (Agent);
        \draw [draw, <-, >=open diamond] (Entity) -- (Sensor);
        \draw [draw, <-, >=open diamond] (Entity) -- (Interface);
%        \draw [draw, <-, >=open diamond] (Simulation) -- node[very near start, above] {1} node[very near end, above] {1} (World);
%        \draw [draw, ->, >=open diamond] (Entity) -- node[very near end, above] {1} node[very near start, above] {1..*} (World);
%        \draw [draw, <-, >=open diamond] (Entity) -- node[very near end, right] {0..*} node[very near start, right] {1..*} (Agent);
%        \draw [draw, <-, >=open diamond] (Entity) -- node[very near end, right] {0..*} node[very near start, right] {1..*} (Sensor);
%        \draw [draw, <-, >=open diamond] (Entity) -- node[very near end, right] {0..*} node[very near start, right] {1..*} (Interface);
    \end{tikzpicture}
    \caption{Subsystem Diagram}
    \label{fig-subsystem}
\end{figure}

\subsection{Distribution Diagram}
\begin{figure}[!h]
    \centering
    \includegraphics[scale=.6]{../initial-pres/arch.pdf}
    \caption{Distribution Diagram}
    \label{fig-distribution}
\end{figure}
\section{Detailed System Design}
\subsection{Simulator Components}
\subsubsection{Simulation}
\subsubsection{StartupDaemon}
\subsubsection{Entity}
\subsubsection{Built-in Entities}
\paragraph{Node}
\paragraph{PreScriptedObject}
\subsubsection{World}

\subsection{Networking Components}
\subsubsection{Interface}
\subsubsection{CommsEngine}
\subsubsection{Built-in CommsEngines}
\paragraph{LogLossCommsEngine}
\paragraph{EthernetCommsEngine}

\subsection{Event Components}
\subsubsection{Event}
\subsubsection{Built-in Events}
\paragraph{LinkEvent}
\paragraph{CommunicationSendEvent}
\paragraph{EntityMoveEvent}{Published when an entity moves within the simulation.}

\attributes{
    \attribute{\_entity\_uid}{int}{UID of the entity that moved}
    \attribute{\_lat}{float}{Latitude of new location}
    \attribute{\_lon}{float}{Longitude of new location}
    \attribute{\_agl}{float}{AGL of new location}
    \attribute{\_velocity}{float}{Velocity of movement}
}

\operations
{
    \operation{\_\_init\_\_(entity, lat, lon, agl, velocity)}
    {
        \begin{itemizecompact}
            \item \texttt{entity}: Instance of entity that moved
            \item \texttt{lat}: Latitude of new location
            \item \texttt{lon}: Longitude new location
            \item \texttt{agl}: AGL of new location
            \item \texttt{velocity}: Velocity of movement
        \end{itemizecompact}

    }{None}{Instantiates a new movement action}
    \operation{get\_uid()}{None}{UID}{Gets the UID of the entity that moved}
    \operation{get\_lat()}{None}{Latitude}{Gets the new latitude of the entity that moved}
    \operation{get\_lon()}{None}{Longitude}{Gets the new longitude of the entity that moved}
    \operation{get\_agl()}{None}{AGL}{Gets the new AGL of the entity that moved}
    \operation{get\_velocity()}{Velocity}{None}{Gets the velocity of the entity that moved}
}

\paragraph{StartupEvent}
\paragraph{AckStartupEvent}
\paragraph{StartSimulationEvent}
\paragraph{StopSimulationEvent}

\subsection{Agent Components}
\subsubsection{Agent}
\subsubsection{Condition}
\subsubsection{Action}
\subsubsection{Built-in Actions}
\paragraph{Move}

\subsection{Sensor Components}
\subsubsection{Sensor}

\subsection{Utility Components}
\subsubsection{Geo}
\end{document}
